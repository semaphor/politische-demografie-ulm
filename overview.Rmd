---
title: "(Arbeitstitel) Kleine Datenanalyse/Demografisches zur Ulmer Gemeinderatswahl 2024"
author: "Jakob Pietron, Simon Lüke"
output:
  html_document:
    toc: true
    code_folding: hide
    number_sections: true
  pdf_document:
    toc: true
    number_sections: true
---

```{r echo=FALSE, message=FALSE}
library(ggridges)
library(ggplot2)
library(viridis)
library(hrbrthemes)
library(dplyr)
library(DT)
library(forcats)
library(ggpubr)
library(ragg)

# DATEN EINLESEN UND AUFBEREITEN
# ==============================

# Lokal wird/wurde zur Datenminimierung einmalig clean.R auf unseren Ausgangsdaten ausgeführt.


# KANDIDAT_INNEN/LISTEN:
listen <- read.csv('daten/kandidat_innen-2024-09-06.csv')
colnames(listen) <- c('Beruf', 'Geburtsjahr', 'Stadtteil', 'Liste')
listen$Stadtteil <- as.factor(listen$Stadtteil)
listen$Liste <- as.factor(listen$Liste)
# Alter aus Geburtsjahr errechnen:
listen <- listen %>% mutate(Alter = 2024 - Geburtsjahr)
# Urspr. Berufsangabe in neue Spalte sichern:
listenHelper <- cbind(listen$Beruf, listen)
names(listenHelper) <- c("BerufAngabe",names(listen))
listen <- listenHelper
rm(listenHelper)

#AKTUELLER GEMEINDERAT:
aktRat <- read.csv('daten/aktueller_gemeinderat_2024-03.csv')
aktRat <- aktRat %>% mutate(Alter = 2024 - Geburtsjahr)

demografieUlmMedian = 40

# ALTER ULM, Ulmer Statisitik 2023:
demografieUlm2023 <- read.csv('daten/demografie_ulm-2023-12-31-ulmer_statistik.csv')
names(demografieUlm2023)[11] <- "Wohnbevölkerung"
# Upsampling, so irgendwie (das geht sicher besser?)
demografieUlm2023Distr <- vector()
for (i in seq_along(demografieUlm2023$Wohnbevölkerung)) {
  #mittleresAlter <- demografieUlm$Altersgruppe[i] + (demografieUlm$Altersgruppe[i+1] - demografieUlm$Altersgruppe[i]) / 2
  #if (is.na(mittleresAlter)) mittleresAlter <- 75
  demografieUlm2023Distr <- c(demografieUlm2023Distr, rep(demografieUlm2023$Alter.von[i], round(demografieUlm2023$Wohnbevölkerung[i])))
}
demografieUlm2023Distr <- as.data.frame(demografieUlm2023Distr)
demografieUlm2023Distr <- cbind(demografieUlm2023Distr,'Ulm')
#demografieUlmDistr <- cbind(NA, NA, NA, NA, 'Ulm', demografieUlmDistr)
names(demografieUlm2023Distr) <- c('Alter', 'Liste')


# ALTER ULM, DESTATIS:
demografieUlmGenderBi <- read.csv('daten/demografie_ulm-2022-12-31-statistisches_bundesamt.csv')
demografieUlmGenderBi$Geschlecht <- as.factor(demografieUlmGenderBi$Geschlecht)
# Nur zwei Geschlechter? Raus damit:
demografieUlmAnzAltersgruppen <- length(unique(demografieUlmGenderBi$Altersgruppe))
demografieUlmMtx <- matrix(nrow = demografieUlmAnzAltersgruppen, ncol = 2)
demografieUlmMtx[,1] <- sort(unique(demografieUlmGenderBi$Altersgruppe))
for (pos in seq(demografieUlmAnzAltersgruppen)) {
  demografieUlmMtx[pos,2] <- sum(demografieUlmGenderBi$Personen[demografieUlmGenderBi$Altersgruppe == demografieUlmMtx[pos,1]])
}
demografieUlm <- data.frame(demografieUlmMtx)
names(demografieUlm) <- names(demografieUlmGenderBi)[2:3]
# Altersgruppen in Schritten von zehn Jahren:
demografieUlm <- demografieUlm %>% mutate(AltersgruppeZehner = cut(Altersgruppe, breaks = seq(from = 0, to = 80, by = 10), right = FALSE))
levels(demografieUlm$AltersgruppeZehner)[levels(demografieUlm$AltersgruppeZehner) == "[70,80)"]  <- "[70,...)" 
demografieUlmZehner <- demografieUlm %>% select(any_of(c("AltersgruppeZehner", "Personen"))) %>%
  group_by(AltersgruppeZehner) %>% 
  summarise(across(everything(), sum))
rm(pos, demografieUlmMtx, demografieUlmAnzAltersgruppen)
# Upsampling, so irgendwie (das geht sicher besser?)
demografieUlmDistr <- vector()
for (i in seq_along(demografieUlm$Personen)) {
  mittleresAlter <- demografieUlm$Altersgruppe[i] + (demografieUlm$Altersgruppe[i+1] - demografieUlm$Altersgruppe[i]) / 2
  if (is.na(mittleresAlter)) mittleresAlter <- 75
  demografieUlmDistr <- c(demografieUlmDistr, rep(mittleresAlter ,round(demografieUlm$Personen[i])))
}
demografieUlmDistr <- as.data.frame(demografieUlmDistr)
demografieUlmDistr <- cbind(NA, NA, NA, NA, 'Ulm', demografieUlmDistr)
names(demografieUlmDistr) <- c('BerufAngabe', 'Beruf', 'Geburtsjahr', 'Stadtteil', 'Liste', 'Alter')

# Extra data.frame: listen + demografieUlmDistr:
listenMitDemografieUlm <- rbind(demografieUlmDistr, listen)

```


# Einleitung

Skizze:

* Wir halten für unsere Wahlentscheidungen Inhalte und Ziele der Listen als am wichtigsten. Dazu leider dieses Jahr kein Wahl-o-Mat, aber Websites der Listen, Diksussionsrunden, ggf. Presse.
* Für die Entscheidungen und Arbeit der Gemeinderät:innen aber auch wichtig sind die persönlichen Perspektiven und Erfahrungen. Jeder ist inidviudell, aber ein Blick auf die Statistik kann auch beitragen, um sich zur Stimmangabe ein Bild zu verschaffen.
* Deshalb hier ein Blick auf die Altersstrukturen und beruflichen Hintergründe/Tätigkeiten.
* Darunter dann ein ausführlichere/detaillierte Zusammenstellung der Daten und Informationen zur Vorgehensweise und den Quellen.
  * Zum selber blättern/tiefer reinschauen
  * Und ggf. selber weitermachen: offen z.B. noch Asuwertung mit Blick auf die Stadtteile; evtl. ist auch eine Auswertung nach Geschlechtern möglich.


# Auf einen Blick

Skizze:

1. Altersstruktur
   a. Kandidati:innen der Listen versus Bevölkerung
   a. aktueller Gemeinderat versus Bevölkerung
1. Beruflicher Hintergrund und Tätigkeiten
   a. Berufsgruppen
   a. aktuelle Tätigkeiten (da müssen wir wohl etwas mutmaßen, könnte man ja aber in einem Absatz erklären)


# Ausführlicher Bericht

## Altersstruktur

### Kandidat:innen zur Ulmer Gemeinderatswahl am 9.6.2024

Insgesamt kandidieren für die Wahl am 9.6.2024 `r nrow(listen)` Kandidat_innen auf `r length(levels(listen$Liste))` Listen für den nächsten Ulmer Gemeinderat (Wahlperiode 2024-2029).


```{r}

# TODO/VERBESSERUNG Eintrag für Ulmer Bevölkerung in Tabelle aufnehmen.
#rbind(DiesDas, listen) %>%

listen %>%
  group_by(Liste) %>%
  summarise(
    "Kandidat_innen" = n(),
    "min. Alter" = min(Alter),
    "max. Alter" = max(Alter),
    "Alter, Median" = median(Alter),
    "Alter, Durchschnitt" = round(mean(Alter),1),
    "Alter, Standardabw." = round(sd(Alter))
    ) %>%
  datatable(style = 'bootstrap')

```

Grafische Darstellung:

* Eintrag "BEVÖLKERUNG": stellt zum Vergleich die gesamte Ulmer Bevölkerung dar [2].
* Histogram: TODO.
* Kurve: Annährung zur bessere Darstellung. Normierung auf Fläche unter der Kurve.
  * Da es sich um eine Annäherung und nicht um eine exakt Reprästentazion der Alterswerte handelt, verläuft die Kurz bspw. teilw. in Bereiche < 16 Jahre, also unter das Wahlalter.
* Blauer Strich: Median als Mittelwert.
* Grüner Strich: Wahlalter 16 Jahre.


```{r echo=FALSE, message=FALSE, warning=FALSE, results='hide',fig.keep='all'}

#http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/#a-colorblind-friendly-palette
# The palette with grey:
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")

# The palette with black:
cbbPalette <- c("#000000", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")

# To use for fills, add
#scale_fill_manual(values=cbbPalette)

# To use for line and point colors, add
#scale_colour_manual(values=cbbPalette)
```

```{r fig.width=8, fig.height=10}

listen <- listen %>% 
  mutate(Liste = fct_reorder(Liste, Alter, .fun='median'))

listenLabels <- listen %>%
  group_by(Liste) %>%
  summarise(n = n()) %>%
  mutate(text = paste0(Liste, ' (n=', n, ')'))

plotAgeListen <- listen %>%
  ggplot(aes(x = Alter, y = Liste)) + #, fill = after_stat(x))) +
  geom_density_ridges_gradient(
    scale = 2.1, 
    rel_min_height = 0.01, 
    bandwidth = 1.5,
    quantile_lines = TRUE,
    vline_color = c("#56B4E9"),
    vline_width = 1.5,
    quantile_fun = median,
    jittered_points = TRUE, #https://cran.r-project.org/web/packages/ggridges/vignettes/introduction.html
    position = position_points_jitter(width = 0.7, height = 0),
    point_shape = 20, #https://ggplot2.tidyverse.org/reference/aes_linetype_size_shape.html
    point_size = 2, point_alpha = .5, alpha = 0.7
    ) +
  geom_vline(xintercept = 16, colour="#009E73", linetype = "longdash", linewidth = 0.8, show.legend = TRUE) +
  geom_vline(xintercept = demografieUlmMedian, colour="#56B4E9", linetype = "longdash", linewidth = 0.8, show.legend = TRUE) +
  scale_fill_viridis() +
  scale_y_discrete(limits=rev, labels=rev(listenLabels$text)) +
  scale_x_continuous(limits=c(0,90), breaks=seq(0, 90, by=5)) +
  labs(title = 'Altersverteilungen') +
  theme_ipsum() +
  theme(
    legend.position="none",
    panel.spacing = unit(0.1, "lines"),
    strip.text.x = element_text(size = 8),
    axis.title.y=element_blank(),
    axis.title.x=element_blank()
  )
#plotAgeListen
```

```{r fig.width=6, fig.height=2.3}
#options(repr.plot.width = 5, repr.plot.height = 2) 
plotDemografieUlmDistr <- demografieUlm2023Distr %>%
  ggplot(aes(x = Alter, y = Liste)) + #, fill = after_stat(x))) +
  geom_density_ridges_gradient(
    scale = 45,
    rel_min_height = 0.01,
    bandwidth = 1,
    quantile_lines = TRUE,
    vline_color = c("#56B4E9"),
    vline_width = 1.5,
    quantile_fun = median
    ) +
  geom_vline(xintercept = 16, colour="#009E73", linetype = "longdash", linewidth = 0.8) +
  geom_vline(xintercept = demografieUlmMedian, colour="#56B4E9", linetype = "longdash", linewidth = 0.8) +
  #scale_fill_viridis() +
  #scale_y_discrete(limits=rev, labels=rev(listenLabels$text)) +
  scale_x_continuous(limits=c(0,91), breaks=seq(0, 90, by=5)) +
  #labs(title = 'Altersverteilung Ulmer Bevölkerung') +
  theme_ipsum() +
  theme(
    legend.position="none",
    panel.spacing = unit(0.1, "lines"),
    strip.text.x = element_text(size = 8),
    axis.title.y=element_blank(),
    axis.title.x=element_blank()
  )
#plotDemografieUlmDistr
```


```{r fig.width=6, fig.height=2.3}
#options(repr.plot.width = 5, repr.plot.height = 2) 
plotAktRat <- aktRat %>%
  mutate(Fraktion = "Gemeinderat\n2019-2024") %>%
  ggplot(aes(x = Alter, y = Fraktion)) + #, fill = after_stat(x))) +
  geom_density_ridges_gradient(
    scale = 45,
    rel_min_height = 0.01,
    bandwidth = 1,
    quantile_lines = TRUE,
    vline_color = c("#56B4E9"),
    vline_width = 1.5,
    quantile_fun = median,
    jittered_points = TRUE, #https://cran.r-project.org/web/packages/ggridges/vignettes/introduction.html
    position = position_points_jitter(width = 0.7, height = 0),
    point_shape = 20, #https://ggplot2.tidyverse.org/reference/aes_linetype_size_shape.html
    point_size = 2, point_alpha = .5, alpha = 0.7
    ) +
  geom_vline(xintercept = 16, colour="#009E73", linetype = "longdash", linewidth = 0.8) +
  geom_vline(xintercept = demografieUlmMedian, colour="#56B4E9", linetype = "longdash", linewidth = 0.8) +
  #scale_fill_viridis() +
  #scale_y_discrete(limits=rev, labels=rev(listenLabels$text)) +
  scale_x_continuous(limits=c(0,91), breaks=seq(0, 90, by=5)) +
  #labs(title = 'Altersverteilung Ulmer Bevölkerung') +
  theme_ipsum() +
  theme(
    legend.position="none",
    panel.spacing = unit(0.1, "lines"),
    strip.text.x = element_text(size = 8),
    axis.title.y = element_blank(),
    axis.title.x = element_blank()
  )
#plotAktRat

plotAktRatMinus5 <- aktRat %>%
  mutate(Fraktion = "Gemeinderat\n2019-2024\n-5 Jahre", Alter = Alter - 5) %>%
  ggplot(aes(x = Alter, y = Fraktion)) + #, fill = after_stat(x))) +
  geom_density_ridges_gradient(
    scale = 45,
    rel_min_height = 0.01,
    bandwidth = 1,
    quantile_lines = TRUE,
    vline_color = c("#56B4E9"),
    vline_width = 1.5,
    quantile_fun = median,
    jittered_points = TRUE, #https://cran.r-project.org/web/packages/ggridges/vignettes/introduction.html
    position = position_points_jitter(width = 0.7, height = 0),
    point_shape = 20, #https://ggplot2.tidyverse.org/reference/aes_linetype_size_shape.html
    point_size = 2, point_alpha = .5, alpha = 0.7
    ) +
  geom_vline(xintercept = 16, colour="#009E73", linetype = "longdash", linewidth = 0.8) +
  geom_vline(xintercept = demografieUlmMedian, colour="#56B4E9", linetype = "longdash", linewidth = 0.8) +
  #scale_fill_viridis() +
  #scale_y_discrete(limits=rev, labels=rev(listenLabels$text)) +
  scale_x_continuous(limits=c(0,91), breaks=seq(0, 90, by=5)) +
  #labs(title = 'Altersverteilung Ulmer Bevölkerung') +
  theme_ipsum() +
  theme(
    legend.position="none",
    panel.spacing = unit(0.1, "lines"),
    strip.text.x = element_text(size = 8),
    axis.title.y=element_blank(),
    #axis.title.x=element_blank()
  )
```

```{r fig.width=8, fig.height=18, echo=FALSE, message=FALSE, warning=FALSE, results='hide', fig.keep='all'}
plotUnten <- ggarrange(NA, plotDemografieUlmDistr,
         #heights = c(12, 1.6),
         widths = c(0.27, 1),
         nrow = 1, ncol = 2)

plotGanzUnten <- ggarrange(NA, plotAktRat,
         #heights = c(12, 1.6),
         widths = c(0.15, 1),
         nrow = 1, ncol = 2)

plotGanzGanzUnten <- ggarrange(NA, plotAktRatMinus5,
         #heights = c(12, 1.6),
         widths = c(0.15, 1),
         nrow = 1, ncol = 2)

suppressWarnings(
  ggarrange(plotAgeListen, plotUnten, plotGanzUnten, plotGanzGanzUnten,
         heights = c(12, 1.6, 1.6, 1.6),
         vjust = 0,
         #widths = c(1, 0.5),
         nrow = 4, ncol = 1)
)
# http://www.sthda.com/english/articles/24-ggpubr-publication-ready-plots/81-ggplot2-easy-way-to-mix-multiple-graphs-on-the-same-page/
```

### Aktueller Gemeinderat (Wahlperiode 2019-2024)

```{r fig.width=6, fig.height=2.5}
ggplot(aktRat,  aes(x = Alter, y = NA)) + 
  #geom_histogram(width = 0.5, binwidth = 1)
  geom_density_ridges_gradient(
    scale = 45,
    rel_min_height = 0.01,
    bandwidth = 1,
    quantile_lines = TRUE,
    vline_color = c("#56B4E9"),
    vline_width = 1.5,
    quantile_fun = median,
    jittered_points = TRUE, #https://cran.r-project.org/web/packages/ggridges/vignettes/introduction.html
    position = position_points_jitter(width = 0.7, height = 0),
    point_shape = 20, #https://ggplot2.tidyverse.org/reference/aes_linetype_size_shape.html
    point_size = 2, point_alpha = .5, alpha = 0.7
    ) +
  scale_x_continuous(limits=c(25, 85), breaks=seq(30, 80, by=10)) +
  theme_ipsum() +
  theme(
    legend.position="none",
    panel.spacing = unit(0.1, "lines"),
    strip.text.x = element_text(size = 8),
    axis.title.y=element_blank(),
    axis.text.y=element_blank(),
    #axis.title.x=element_blank()
  )
```


### Bevölkerung Ulms

Die in diesem Bricht verwendetetn Daten zur Altersverteilung der Ulmer Bevölkerung stammen aus der  Ulmer Statistik 2023 [2], die Daten mit dem Stand vom 31.12.2023 enthält.

* Gesamtzahl Wohnbevölkerung: n = TODO
* Auflösung: Altersgruppen von je 1 Jahr, ab 0 Jahren.
* Letzter Datenpunkt: 90 Jahre und älter, deshalb ein Ausreißer nach oben.


```{r fig.width=6, fig.height=2}


plotAgeUlm2023Distr <- ggplot(demografieUlm2023Distr, aes(Alter)) + 
  geom_histogram(binwidth = 1)

plotAgeUlm2023Distr

# Zum Vergleich hier optional eine Darstellung der ursprünglichen Daten aus [2]:
#plotAgeUlm2023 <- ggplot(demografieUlm2023, aes(Alter.von, Wohnbevölkerung)) + 
#  geom_col(width = 0.5)
#
#plotAgeUlm2023


```

Alternativ stellt das Statstische Bundesamt auch noch folgende Altersdaten mit akttuell letztem Stand vom 31.12.2022 [3] zur Verfügung. Diese sind etwas älter und vor allem weniger fein aufgelöst; damit hier nur eine ergänzende Darstellung.

* Gesamtzahl Wohnbevölkerung: n = TODO

```{r fig.width=5.4, fig.height=2}
plotAgeUlm2022DES <- ggplot(demografieUlmZehner, aes(AltersgruppeZehner, Personen)) + 
  geom_col(width = 0.8)

plotAgeUlm2022DES


```


## Beruflicher Hintergrund und Tätigkeiten

Skizze:

* Hier kommt wesentlich mehr Interpretation rein, z.B. die Zusammenfassung der Berufsangaben "Einzelunternehmer", "selbst. Unternehmer", "selbst. Unternehmerin" und "	Unternehmer IT-Services" zu "Unternehmer_in".
* Die vollständige Liste, die alle angegebenen Berufe enthält, finden Sie der [Datei kandidat_innen-2024-09-06.csv auf GitHub](https://github.com/semaphor/politische-demografie-ulm/blob/main/daten/kandidat_innen-2024-09-06.csv).

```{r}

# Berufsangaben redaktionell bereinigen:
#  * gegenderte Bezeichnungen
#  * rausschmeißen "i.R." "selbst." 

listen <- listen %>%
  mutate(Beruf = replace(Beruf, Beruf == "Student" | Beruf == 'Studentin', "Student_in")) %>%
  mutate(Beruf = replace(Beruf, Beruf == "Schüler" | Beruf == 'Schülerin', "Schüler_in")) %>%
  mutate(Beruf = replace(Beruf, Beruf == "Auszubildender" | Beruf == 'Auszubildende', "Auszubildende_r")) %>%
  mutate(Beruf = replace(Beruf, Beruf == "Arzt" | Beruf == 'Ärztin', "Ärzt_in")) %>%
  mutate(Beruf = replace(Beruf, Beruf == "Architekt" | Beruf == 'Architektin' | Beruf == "Freie Architektin", "Architekt_in")) %>%
  mutate(Beruf = replace(Beruf, Beruf == "Fraktionsgeschäftsführer" | Beruf == 'Fraktionsgeschäftsführerin', "Fraktionsgeschäftsführer_in")) %>%
  mutate(Beruf = replace(Beruf, Beruf == "Lehrer" | Beruf == 'Lehrerin' | Beruf == "Lehrer i.R." | Beruf == "Gymnasiallehrer" | Beruf == "Gymnasiallehrerin" | Beruf == "Kunstlehrerin", "Lehrer_in")) %>%
    mutate(Beruf = replace(Beruf,Beruf == "techn. Oberlehrer i.R." | Beruf == "techn. Oberlehrerin", "Berufsschullehrer_in")) %>%
  mutate(Beruf = replace(Beruf, Beruf == "Dipl. Betriebswirt (BA)" | Beruf == 'Dipl.- Betriebswirt (BA)' | Beruf == "	Dipl.-Betriebswirt (BA)", "Dipl. Betriebswirt_in (BA)")) %>%
  mutate(Beruf = replace(Beruf, Beruf == "selbst. Dipl.-Informatiker" | Beruf == 'Dipl.-Informatikerin', "Dipl.-Informatiker_in")) %>%
  mutate(Beruf = replace(Beruf, Beruf == "selbständig", "selbstständig")) %>%
  mutate(Beruf = replace(Beruf, Beruf == "Unternehmer" | Beruf == "Einzelunternehmer" | Beruf == "selbst. Unternehmer" | Beruf == "selbst. Unternehmerin" | Beruf == "Unternehmer IT-Services", "Unternehmer_in")) %>%
  mutate(Beruf = replace(Beruf, Beruf == "Geschäftsführer" | Beruf == "Geschäftsführerin", "Geschäftsführer_in")) %>%
  mutate(Beruf = replace(Beruf, Beruf == "Bankkaufmann" | Beruf == "Bankkauffrau", "Bankkaufleute")) %>%
  mutate(Beruf = replace(Beruf, Beruf == "Rechtsanwalt" | Beruf == "Rechtsanwältin" | Beruf == "Rechtsanwältin i.R.", "Rechtsanwält_in")) %>%
  mutate(Beruf = replace(Beruf, Beruf == "Rechtsanwaltsfach- angestellte", "Rechtsanwaltsfachangestellte")) %>%
  mutate(Beruf = replace(Beruf, Beruf == "kaufm. Angestellter", "kaufm. Angestellte_r")) %>%
  mutate(Beruf = replace(Beruf, Beruf == "Kaufmann" | Beruf == "IT-Systemkaufmann" | Beruf == "Speditionskaufmann" | Beruf == "selbst. Kaufmann", "Kaufleute")) %>%
  #mutate(Beruf = replace(Beruf, Beruf == "" | Beruf == "", "")) %>%
  #mutate(Beruf = replace(Beruf, Beruf == "" | Beruf == "", "")) %>%
  #mutate(Beruf = replace(Beruf, Beruf == "" | Beruf == "", "")) %>%
  mutate(Beruf = replace(Beruf, Beruf == "Psychologe" | Beruf == 'Psychologin' | Beruf == "Sportpsychologe" | Beruf == "Psychologin (B.sc.)", "Psycholog_in"))
#Psychologische Beraterin i.R.? Psychologische Psychotherapeutin?

# Neue Spalte Tätigkeit:
listenHelper <- cbind(listen$Beruf, listen)
names(listenHelper) <- c("Tätigkeit",names(listen))
listen <- listenHelper
rm(listenHelper)

# Über Tätigkeiten stärker zusammenfassen:
listen <- listen %>%
  mutate(Tätigkeit = replace(Tätigkeit, Tätigkeit == "Lehrer_in" | Tätigkeit == "techn. Oberlehrer i.R." | Tätigkeit == "techn. Oberlehrerin", "Lehrer_in")) %>%
  mutate(Tätigkeit = replace(Tätigkeit, Tätigkeit == "Augenoptikerin" | Tätigkeit == "Augenoptikermeister", "Augenoptiker_in")) %>%
  mutate(Tätigkeit = replace(Tätigkeit, Tätigkeit == "Dipl.-Ingenieur" | Tätigkeit == "Wirtschaftsingenieur" | Tätigkeit == "Dipl.-Ingenieur (FH)" | Tätigkeit == "Ingenieur" | Tätigkeit == "Dipl.-Ingenieur (BA)" | Tätigkeit == "Dipl.-Ingenieur agr." | Tätigkeit == "Entwicklungsingenieur" | Tätigkeit == "selbst. Bauingenieurin", "Ingenieur_in")) %>%
  mutate(Tätigkeit = replace(Tätigkeit, Tätigkeit == "Dipl.-Informatiker_in" | Tätigkeit == "Informatiker" | Tätigkeit == "Informatikkauffrau" | Tätigkeit == "selbst. Wirtschaftsinformatiker (B.Sc.)", "Informatiker_in")) %>%
  mutate(Tätigkeit = replace(Tätigkeit, Tätigkeit == "Bankkaufleute" | Tätigkeit == "Bankbetriebswirt" | Tätigkeit == "Bankfachwirtin", "Bankkaufleute u. -(fach-)wirtin")) %>%
  mutate(Tätigkeit = replace(Tätigkeit, Tätigkeit == "Bürokauffrau" | Tätigkeit == "kaufm. Angestellte" | Tätigkeit == "Dipl.-Kaufmann" | Tätigkeit == "" | Tätigkeit == "" | Tätigkeit == "" | Tätigkeit == "", "Kaufleute")) %>%
  #mutate(Tätigkeit = replace(Tätigkeit, Tätigkeit == "" | Tätigkeit == "", "")) %>%
  #mutate(Tätigkeit = replace(Tätigkeit, Tätigkeit == "" | Tätigkeit == "", "")) %>%
  #mutate(Tätigkeit = replace(Tätigkeit, Tätigkeit == "" | Tätigkeit == "", "")) %>%
  #mutate(Tätigkeit = replace(Tätigkeit, Tätigkeit == "" | Tätigkeit == "", "")) %>%
  mutate(Tätigkeit = replace(Tätigkeit, Tätigkeit == "Psycholog_in" | Tätigkeit == 'Psychologische Beraterin i.R.' | Tätigkeit == "Psychologische Psychotherapeutin", "Psycholog_in"))
# So, gut jetzt für heute, bei Kaufleuten und Betriebswirten.

# Zur Refrenez beim Durcharbeiten erstmal eine Tabelle mit den Originalanageben:
berufeAngabe <- listen %>%
            group_by(BerufAngabe) %>%
            summarise(n = n()) %>%
            arrange(desc(n))

berufeAngabe %>%
  datatable(style = 'bootstrap', filter = 'top')

# Redaktionelle Zusammenfassung:
berufe <- listen %>%
            group_by(Beruf) %>%
            summarise(n = n()) %>%
            arrange(desc(n))

berufe %>%
  datatable(style = 'bootstrap', filter = 'top')

# Zusammenfassung Tätigkeit:
taetigkeiten <- listen %>%
            group_by(Tätigkeit) %>%
            summarise(n = n()) %>%
            arrange(desc(n))

taetigkeiten %>%
  datatable(style = 'bootstrap', filter = 'top')

```


# Vorgehensweise, Quellen und Autor_innen

Datenverarbeitung und Visualisierung mit der Statistiksoftware R. Automatisierte Erstellung des reproduzier- und nachvollziehbaren Berichts mit R Markdown. Veröffentlichung im Web mit GitHub (Actions). Tausend  Dank an alle Autor_innen der unzähligen genutzten Softwarepakte!

Daten und nachvollziehbare Datenverarbeitung auf GitHub: <https://github.com/semaphor/politische-demografie-ulm>

Quellen:

* [1] Öffentliche Bekanntmachung der Wahlvorschläge zur Wahl des Gemeinderats und der Ortschaftsräte am 09. Juni 2024, Stadt Ulm, 04.04.2024, [Link](https://www.ulm.de/-/media/ulm/zdv/downloads/oeffentliche-bekanntmachungen/2024/april-2024/20240404zugelassene-wahlvorschlge-zur-wahl-des-gemeinderats-und-der-ortschaftsrte-am-09-juni-2024sig.pdf)
* [2] Die "Ulmer Statistik 2023" würde noch feiner aufgelöste und aktuellere Daten zur Alterstruktur enthalten [Link](https://www.ulm.de/-/media/ulm/bd/bd-iv/statistik-und-wahlen/statistik/downloads/2023-ulmer-statistik-red/2023-ulmer-statistik-red1.pdf)
* [3] Tabelle 12411-0018 "Bevölkerung: Kreise, Stichtag, Geschlecht, Altersgruppen" für "Ulm, kreisfreie Stadt" (Code 08421), per 31.12.2022, Statistisches Bundesamt, [Link](https://www-genesis.destatis.de/genesis//online?operation=table&code=12411-0018&bypass=true&levelindex=0&levelid=1716154099952#abreadcrumb)
* [4] Zusammensetzung Ulmer Gemeinderat Wahlperiode 2019-2024:
  * Webseiten der Stadt Ulm, [Link](https://www.ulm.de/rathaus/stadtpolitik/gemeinderat)
  * Alter: Internetrecherche, diverse Quellen (auf Nachfrage bei den Autor\*innen)

Von: Jakob Pietron, Simon Lüke

Lizenz:

Kontakt:
TODO