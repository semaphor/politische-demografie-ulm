---
title: "ENTWURF! Datenanalyse zur Ulmer Gemeinderatswahl 2024"
subtitle: "Vergleich Altersstruktur von Bevölkerung, Wahllisten und Gemeinderat"
date: "28.5.2024"
author: "Jakob Pietron, Simon Lüke"
bibliography: quellen.bib
csl: eva-berlin-konferenz.csl
link-citations: true
output:
  html_document:
    toc: true
    code_folding: hide
    number_sections: true
  pdf_document:
    toc: true
    number_sections: true
---


```{r message=FALSE}

# DIE SCHULTERN VIELER ANDERER, DANKE
# ===================================

library(ggridges)
library(ggplot2)
library(knitr)
library(viridis)
library(hrbrthemes)
library(dplyr)
library(DT)
library(forcats)
library(ggpubr)
library(ragg)


# DATEN EINLESEN UND AUFBEREITEN
# ==============================

# Lokal wird/wurde zur Datenminimierung einmalig clean.R auf unseren Ausgangsdaten ausgeführt.


# KANDIDAT_INNEN/LISTEN:
#TODO Lfd.-Nr. wieder reinnehmen?
listen <- read.csv('daten/kandidat_innen-2024-09-06.csv')
colnames(listen) <- c('Beruf', 'Geburtsjahr', 'Stadtteil', 'Liste')
listen$Stadtteil <- as.factor(listen$Stadtteil)
listen$Liste <- as.factor(listen$Liste)
# Alter aus Geburtsjahr errechnen:
listen <- listen %>% mutate(Alter = 2024 - Geburtsjahr)
# Urspr. Berufsangabe in neue Spalte sichern:
listenHelper <- cbind(NA, listen$Beruf, listen)
names(listenHelper) <- c("Tätigkeit", "BerufAngabe", names(listen))
listen <- listenHelper
rm(listenHelper)
# Nach Median aufsteigend sortieren (schonmal hier, wird in den meisten Plots so gemacht):
listen <- listen %>% 
  mutate(Liste = fct_reorder(Liste, Alter, .fun='median'))
# n zählen:
listenLabels <- listen %>%
  group_by(Liste) %>%
  summarise(n = n()) %>%
  mutate(text = paste0(Liste, ' (n=', n, ')'))


# WAHLBERECHTIGTE:
#TODO offizielle Quelle finden/anfragen
wahlberechtigte=92000 # SWP-Artikel [@swp:wahlunterlagen]


#AKTUELLER GEMEINDERAT:
aktRat <- read.csv('daten/aktueller_gemeinderat_2024-03.csv')
aktRat <- aktRat %>% mutate(Alter = 2024 - Geburtsjahr)


# ALTER ULM, Ulmer Statisitik 2023:
demografieUlm2023 <- read.csv('daten/demografie_ulm-2023-12-31-ulmer_statistik.csv')
names(demografieUlm2023)[11] <- "Wohnbevölkerung"
# Upsampling, so irgendwie (das geht sicher besser?)
demografieUlm2023Distr <- vector()
for (i in seq_along(demografieUlm2023$Wohnbevölkerung)) {
  demografieUlm2023Distr <- c(demografieUlm2023Distr, rep(demografieUlm2023$Alter.von[i], round(demografieUlm2023$Wohnbevölkerung[i])))
}
demografieUlm2023Distr <- as.data.frame(demografieUlm2023Distr)
demografieUlm2023Distr <- cbind(demografieUlm2023Distr,'Ulm')
names(demografieUlm2023Distr) <- c('Alter', 'Liste')
demografieUlm2023Distr <- cbind(NA, NA, NA, NA, NA, demografieUlm2023Distr)
names(demografieUlm2023Distr) <- c('Tätigkeit', 'BerufAngabe', 'Beruf', 'Geburtsjahr', 'Stadtteil', 'Alter', 'Liste')

# Extra data.frame: listen + demografieUlmDistr:
listenMitDemografieUlm2023 <- rbind(demografieUlm2023Distr, listen)

# Median ermitteln:
demografieUlm2023Median = median(demografieUlm2023Distr$Alter)


# ALTER ULM, DESTATIS:
demografieUlmGenderBi <- read.csv('daten/demografie_ulm-2022-12-31-statistisches_bundesamt.csv')
demografieUlmGenderBi$Geschlecht <- as.factor(demografieUlmGenderBi$Geschlecht)
# Nur zwei Geschlechter? Raus damit:
demografieUlmAnzAltersgruppen <- length(unique(demografieUlmGenderBi$Altersgruppe))
demografieUlmMtx <- matrix(nrow = demografieUlmAnzAltersgruppen, ncol = 2)
demografieUlmMtx[,1] <- sort(unique(demografieUlmGenderBi$Altersgruppe))
for (pos in seq(demografieUlmAnzAltersgruppen)) {
  demografieUlmMtx[pos,2] <- sum(demografieUlmGenderBi$Personen[demografieUlmGenderBi$Altersgruppe == demografieUlmMtx[pos,1]])
}
demografieUlm <- data.frame(demografieUlmMtx)
names(demografieUlm) <- names(demografieUlmGenderBi)[2:3]
# Altersgruppen in Schritten von zehn Jahren:
demografieUlm <- demografieUlm %>% mutate(AltersgruppeZehner = cut(Altersgruppe, breaks = seq(from = 0, to = 80, by = 10), right = FALSE))
levels(demografieUlm$AltersgruppeZehner)[levels(demografieUlm$AltersgruppeZehner) == "[70,80)"]  <- "[70,...)" 
demografieUlmZehner <- demografieUlm %>% select(any_of(c("AltersgruppeZehner", "Personen"))) %>%
  group_by(AltersgruppeZehner) %>% 
  summarise(across(everything(), sum))
rm(pos, demografieUlmMtx, demografieUlmAnzAltersgruppen)
# Upsampling, so irgendwie (das geht sicher besser?)
demografieUlmDistr <- vector()
for (i in seq_along(demografieUlm$Personen)) {
  mittleresAlter <- demografieUlm$Altersgruppe[i] + (demografieUlm$Altersgruppe[i+1] - demografieUlm$Altersgruppe[i]) / 2
  if (is.na(mittleresAlter)) mittleresAlter <- 75
  demografieUlmDistr <- c(demografieUlmDistr, rep(mittleresAlter ,round(demografieUlm$Personen[i])))
}
demografieUlmDistr <- as.data.frame(demografieUlmDistr)
demografieUlmDistr <- cbind(NA, NA, NA, NA, 'Ulm', demografieUlmDistr)
names(demografieUlmDistr) <- c('BerufAngabe', 'Beruf', 'Geburtsjahr', 'Stadtteil', 'Liste', 'Alter')

```


# Überblick

Für die eigene Wahlentscheidung können ganz verschiedene Faktoren herangezogen werden.
Oft sind es die Inhalte und Ziele der antretenden Listen bzw. Parteien^[Für die Gemeinderatswahl gibt es [dieses Jahr](https://www.ulmapi.de/mobil-o-mat/) zwar leider keinen Wahl-o-Maten, über die Inhalte des Wahlkampfs kann man sich aber auf den Websites der Listen, bei Diksussionsveranstaltungen und in der Presse informieren.].
Gerade bei Kommunalwahlen werden aber insbesondere die zur Wahl antretenden Personen (Bekanntheit, bisherige Standpunkte, Aktivitäten etc.) als ein weiterer sehr wichtiger Faktor genannt.
Nicht zuletzt werden die Entscheidungen und die Arbeit unserer Politiker:innen aber auch durch ihre individuellen persönlichen Perspektiven und Lebenserfahrungen geprägt.
Auf genau diesen Faktor wollen wir in diesem Bericht einen "statistischen Blick" werfen.
Dabei ist jeder Mensch natürlich erstmal sehr inidviudell.
Bei einer größeren Gruppe, wie den 40 am 9. Juni zu wählenden Gemeinderät:innen, kann der Blick in die Statistik aber helfen, sich vor der Stimmangabe ein noch detaillierteres Bild zu verschaffen.

TODO Motivation:
Anstehende Probleme der nächsten Jahrzehnte: Klimawandel/notwendige -anpassung und Überalterung unserer Gesellschaft (dabei wird auch Ulm erstmal immer älter, bleibt aber eine vergleichsweise junge Stadt [@demogrportal:bw_demogr]).
+ Frage der Repräsentation der Bevölkerung bei den Entscheidungen/Antworten auf diese Fragen in Ulm.

Vorab möchten wir hier aber erstmal allen Kandidat_innen, die unsere Demokratie und die Menschenrechte ernst nehmen, danken!
Und zwar schon dafür, dass Sie sich zur Wahl aufgestellt haben und damit bereit sind sich zu engagieren und sich auch in der Öffentlichkeit den Diskussionen zu stellen.
Und nicht zuletzt auch für die Bereitschaft in den nächsten fünf Jahren die herausfordernden und verantwortungsvollen Aufgaben einer Gemeinderät:in zu übernehmen.

Um die Altersstruktur der zur Wahl stehenden Listen und Kandidat_innen Vergleichen zu können bietet sich als Alters-Mittelwert der Median an.
Diesen Median erhält man, wenn man alle Personen der gewünschten Gruppe dem Alter nach in einer Reihe aufstellt und die Person genau in der Mitte nach ihrem Alter fragt.
**Die mittlere Ulmerin ist aktuell `r demografieUlm2023Median` Jahre alt**.
Ein weiterer wichtiger Wert ist natürlich das **Wahlalter von 16 Jahren**, ab dem man bei dieser Wahl in Baden-Württemberg wählen gehen darf und gewählt werden kann.
(Baden-Württemberg geht mit diesem neidrigen Wahlater übrigens bundesweit voran [@statlabw:kommwahlen2024].)

Die **`r nrow(listen)` zur Wahl stehenden Kandidat_innen sind im Mittel `r median(listen$Alter)` Jahre alt** bzw. `r abs(demografieUlm2023Median - median(listen$Alter))` Jahre älter als die Ulmer Wohnbevölkerung.
Die jüngste Kandidatin ist `r min(listen$Alter)`, die älteste `r max(listen$Alter)`.
Die folgenden Grafik zeigt die Altersverteilung der Kandidat_innen (unten) im Vergleich mit der Ulmer Bevölkerung (oben).
Im unteren Diagramm ist für jede Kandidat_in auf der x-Achse ein schwarzer Punkt eingetragen.
Die Kurven fassen die Verteilung des Alters annäherungsweise zusammen.
Hier und in allen weiteren Grafiken zeigen die farbigen Linien außerdem folgendes an:

* Blaue Linien stellen Medianwerte dar.
* Die gestrichelte blaue Linie markiert immer das Median-Alter der Ulmer Bevölkerung (`r demografieUlm2023Median` Jahre).
* Die etwas dickeren blauen Linien zeigen jeweils den Medianwert für die jeweilige Kurve/Gruppe an.
* Die orange Linie markiert das Wahlalter 16.

```{r fig.width=10, fig.height=2.3, fig.align = 'center'}

# PLOT ULMER BEVÖLKERUNG
# ======================

#TODO Hohen leeren Bereich unterhalb x-Achse verkleinern.
#TODO Verbesserung: Quantile einzeichnen.
#TODO bandwidth = in allen Plots und immer = 1.5

plotDemografieUlmDistr <- demografieUlm2023Distr %>%
  mutate(Liste = paste0('Ulm\n(n = ', length(demografieUlm2023Distr$Alter), ')')) %>%
  ggplot(aes(x = Alter, y = Liste)) +
  geom_density_ridges_gradient(
    bandwidth = 1.5,
    scale = 45,
    rel_min_height = 0.01,
    quantile_lines = TRUE,
    vline_color = c("#56B4E9"),
    vline_width = 1.5,
    quantile_fun = median
    ) +
  geom_vline(xintercept = 16, colour="#E69F00", linewidth = 0.8) +
  geom_vline(xintercept = demografieUlm2023Median, colour="#56B4E9", linetype = "longdash", linewidth = 0.8) +
  #scale_fill_viridis() +
  #scale_y_discrete(limits=rev, labels=rev(listenLabels$text)) +
  scale_x_continuous(limits=c(0, 100), breaks=seq(0, 90, by=5)) +
  #labs(title = 'Altersverteilung Ulmer Bevölkerung') +
  theme_ipsum() +
  theme(
    legend.position="none",
    panel.spacing = unit(0.1, "lines"),
    strip.text.x = element_text(size = 8),
    axis.title.y=element_blank(),
    axis.title.x=element_blank()
  )
#plotDemografieUlmDistr

```

```{r fig.width=10, fig.align = 'center'}

# PLOT ALLE KANDIDAT_INNEN
# ========================

#TODO (nice to have) Quantile einzeichnen.

#TODO (nice to have) Vereinzelte Codeblöcke zusammenfassen.

plotAgeListenAlle <- listen %>%
  mutate(Liste = paste0('Alle Kandidat_innen\n(n = ', length(listen$Alter), ')')) %>%
  ggplot(aes(x = Alter, y = Liste)) +
  geom_density_ridges_gradient(
    scale = 45, 
    rel_min_height = 0.01, 
    bandwidth = 1.5,
    quantile_lines = TRUE,
    vline_color = c("#56B4E9"),
    vline_width = 1.5,
    quantile_fun = median,
    jittered_points = TRUE, #https://cran.r-project.org/web/packages/ggridges/vignettes/introduction.html
    position = position_points_jitter(width = 0.7, height = 0),
    point_shape = 20, #https://ggplot2.tidyverse.org/reference/aes_linetype_size_shape.html
    point_size = 2, point_alpha = .5, alpha = 0.7#,
    ) +
  geom_vline(xintercept = 16, colour="#E69F00", linewidth = 0.8, show.legend = TRUE) +
  geom_vline(xintercept = demografieUlm2023Median, colour="#56B4E9", linetype = "longdash", linewidth = 0.8, show.legend = TRUE) +
  scale_fill_viridis() +
  #scale_y_discrete(limits=rev, labels=rev(listenLabels$text)) +
  scale_x_continuous(limits=c(0, 100), breaks=seq(0, 90, by=5)) +
  theme_ipsum() +
  theme(
    legend.position="none",
    panel.spacing = unit(0.1, "lines"),
    strip.text.x = element_text(size = 8),
    axis.title.y=element_blank(),
    axis.title.x=element_blank()
  )
#plotAgeListenAlle

```

```{r fig.width=10, fig.asp=0.5, message=FALSE, warning=FALSE, results='hide', fig.keep='all', fig.align = 'center'}

# PLOT ULMER BEVÖLKERUNG versus ALLE KANDIDAT_INNEN (Variante: einzelne Diagramme)

# http://www.sthda.com/english/articles/24-ggpubr-publication-ready-plots/81-ggplot2-easy-way-to-mix-multiple-graphs-on-the-same-page/

plotOben <- ggarrange(
  NA, plotDemografieUlmDistr,
  labels = c(NA, NA),
  nrow = 1, ncol = 2,
  widths = c(0.062, 1) #TODO (nice to have) Verhältnis berechnen.
  )

plotUnten <- ggarrange(
  NA, plotAgeListenAlle,
  labels = c(NA, NA),
  nrow = 1, ncol = 2,
  widths = c(0, 1)
  )

suppressWarnings(
ggarrange(
  plotOben,
  plotUnten,
  nrow = 2, ncol = 1,
  heights = c(1,1),
  vjust = 0
  )
)

```

Die 41 Mitglieder des aktuellen Gemeinderats (Wahlperiode 2019-2024) sind zwischen `r min(aktRat$Alter)` und `r max(aktRat$Alter)` Jahre alt, der Alters-Median liegt bei `r median(aktRat$Alter)`.
Also ist **der aktuelle Gemeinderat im Mittel um `r abs(demografieUlm2023Median - median(aktRat$Alter))` Jahre älter als die Ulmer:innen**.
Der im Herbst neu gewählte Oberbürgermeister als 41. Ratsmitglied ist übrigens `r aktRat$Alter[aktRat$Fraktion == "OB"]` Jahre alt.
Zur Darstellung hier nochmal die obige Grafik, ergänzt um eine dritte Altersverteilung des aktuellen Gemeinderats.

```{r fig.width=10, fig.asp=1, fig.align = 'center'}

plotAktRat <- aktRat %>%
  mutate(Fraktion = paste0('Gemeinderat\n2019-2024\n(n = ', length(Alter), ')')) %>%
  # ',\nMedian = ', median(Alter),
  ggplot(aes(x = Alter, y = Fraktion)) + #, fill = after_stat(x))) +
  geom_density_ridges_gradient(
    scale = 45,
    rel_min_height = 0.01,
    bandwidth = 1.5,
    quantile_lines = TRUE,
    vline_color = c("#56B4E9"),
    vline_width = 1.5,
    quantile_fun = median,
    jittered_points = TRUE, #https://cran.r-project.org/web/packages/ggridges/vignettes/introduction.html
    position = position_points_jitter(width = 0.7, height = 0),
    point_shape = 20, #https://ggplot2.tidyverse.org/reference/aes_linetype_size_shape.html
    point_size = 2, point_alpha = .5, alpha = 0.7
    ) +
  geom_vline(xintercept = 16, colour="#E69F00", linewidth = 0.8) +
  geom_vline(xintercept = demografieUlm2023Median, colour="#56B4E9", linetype = "longdash", linewidth = 0.8) +
  #scale_fill_viridis() +
  #scale_y_discrete(limits=rev, labels=rev(listenLabels$text)) +
  scale_x_continuous(limits=c(0,100), breaks=seq(0, 90, by=5)) +
  #labs(title = 'Altersverteilung Ulmer Bevölkerung') +
  theme_ipsum() +
  theme(
    legend.position="none",
    panel.spacing = unit(0.1, "lines"),
    strip.text.x = element_text(size = 8),
    axis.title.y = element_blank(),
    axis.title.x = element_blank()
  )
#plotAktRat

```

```{r fig.width=10, fig.asp=0.8, message=FALSE, warning=FALSE, results='hide', fig.keep='all', fig.align = 'center'}

plotOben <- ggarrange(
  NA, plotDemografieUlmDistr,
  labels = c(NA, NA),
  nrow = 1, ncol = 2,
  widths = c(0.062, 1)
  )

plotMitte <- ggarrange(
  NA, plotAgeListenAlle,
  labels = c(NA, NA),
  nrow = 1, ncol = 2,
  widths = c(0, 1)
  )

plotUnten <- ggarrange(
  NA, plotAktRat,
  labels = c(NA, NA),
  widths = c(0.062, 1),
  nrow = 1, ncol = 2
  )

suppressWarnings(
ggarrange(
  plotOben,
  plotMitte,
  plotUnten,
  nrow = 3, ncol = 1,
  vjust = 0,
  heights = c(1,1,1)
  )
)

```

Allerdings wurde dieser Rat bereits 2019 gewählt.
Würden wir ihn mittels Zeitmaschine, also rein theoretisch, in die anstehende Wahlperiode 2024-2029 holen, müsste man 5 Jahre vom Alter abziehen, wodurch sich zum Vergleich ein neuer Median von `r median(aktRat$Alter) - 5` Jahren ergibt.
Damit wäre der aktuelle Rat immer noch `r abs(demografieUlm2023Median - median(aktRat$Alter)) - 5` Jahre älter als aktuell die Ulmer Bevölkerung.

Zwischenfazit zur Abbildung/Repräsentation der Altersstruktur der Bevölkerung im Gemeinderat:

* Der aktuelle Rat ist im Mittel `r abs(demografieUlm2023Median - median(aktRat$Alter))` Jahre älter als die Ulmer Bevölkerung bzw. `r abs(demografieUlm2023Median - median(aktRat$Alter)) - 5` Jahre, wenn dieser Rat in diesem Jahr gewählt werden würde.
* Die zur Wahl stehenden Kandidat_innen sind im Mittel jünger und nur `r abs(demografieUlm2023Median - median(listen$Alter))` Jahre älter als die Ulmer:innen.
* In den Grafiken erkennt man, dass bei der Ulmer Bevölkerung ein Schwerpunkt bei den 20- bis 40-jährigen liegt, bei den zur Wahl stehenden Kandidat:innen und dem aktuellen Geeinderat der Schwerpunkt bei den 50- bis 70-jährigen liegt.

Für die anstehende Wahl und das Thema Repräsentation ist also die Frage interessant, ob von den zur Wahl stehenden Kandidat:innen in Ulm üblicher Weise mehr der älteren gewählt werden?
Uns liegen zwar die Wahlvorschläge von 2019 vor, allerdings leider ohne Angabe der Geburtsjahre.
Soweit können wir hier also nur die obigen Grafiken und Zahlenwerte sprechen lassen und zu dieser Frage leider keinen konkreten Vergleich anhand der letzten Wahl präsentieren.

Welches Bild ergibt sich nun, wenn man auf die Alterststruktur der `r length(levels(listen$Liste))` Listen schaut?
**Im Median sind nur 2 der 16 Listen jünger als die Ulmer Bevölkerung**:
Die Junge Ulmer Liste (JUL) mit `r median(listen$Alter[listen$Liste == "JUL"])` und die Tierschutzpartei mit `r median(listen$Alter[listen$Liste == "Tierschutzpartei"])` Jahren (relativ zur Bevölkerung sind sie `r abs(demografieUlm2023Median - median(listen$Alter[listen$Liste == "JUL"]))` bzw. `r abs(demografieUlm2023Median - median(listen$Alter[listen$Liste == "Tierschutzpartei"]))` Jahre jünger).
Die 14 anderen Listen sind sozusagen älter als die Ulmer:innen.
Die Median-Werte liegen zwischen `r median(listen$Alter[listen$Liste == "BLO"])` und `r median(listen$Alter[listen$Liste == "UfA"])` Jahren (relativ zur Bevölkerung also zwischen `r abs(demografieUlm2023Median - median(listen$Alter[listen$Liste == "BLO"]))` und `r abs(demografieUlm2023Median - median(listen$Alter[listen$Liste == "UfA"]))`).
Aufsteigend nach Median-Alter sotiert sind das die Listen BLO, ... TODO, ... UfA.
Auch mit einem um fünf Jahr nach unten korrgierten Median-Alter von 57 Jahren liegt der aktuelle Gemeindrat über dem  Median-Alter der "ältesten" Liste Ulm für Alle (UfA).

Um sich ein besseres Bild machen zu können, sollte man neben den Mittlwerten, auch die Altersverteilungen^[
Zur Veranschaulitung des Themas Verteilungen ein Gedankenexperiment:
Zuerst sortiert man die Listen nach per Median und dabei den jüngsten zuerst nach Alter und merkt sich aus dieser die ersten fünf Plätze.
Dann nochmal umgekehrt sortieren, also mit den ältesten Listen zuerst.
Schaut man nun wieder auf die ersten fünf Plätze, seht man im Vergleich, dass FIXME (GRÜNE) und Ulm für Alle (UfA) beides mal in den ersten fünf Plätzen mit dabei sind.
Schaut man wiederum auf den Median sieht man dass GRÜNE mit `r median(listen$Alter[listen$Liste == "GRÜNE"])` Jahren (relativ `r abs(demografieUlm2023Median - median(listen$Alter[listen$Liste == "GRÜNE"]))` Jahre älter) sehr "mittig" sind, UfA aber die "älteste" Liste im Feld stellt (`r median(listen$Alter[listen$Liste == "UfA"])`; relativ `r abs(demografieUlm2023Median - median(listen$Alter[listen$Liste == "UfA"]))`).
Beide haben also eine sehr weite Bandbreit beim Alter ihrer Kandidat:innen, aber jeweils einen ganz unterschiedlichen Mittelwert.
Über das Alter der anderen Kandidat:innen zwischen jüngstem, mittlerer und ältester ist damit aber auch noch nichts gesagt.
An diesem Gedankenexperiment erkannt man wie einfach es ist mit "Statsitiken zu lügen" (wie das Sprichwort sagt), wenn man nur ganz bestimmte Werte auswählt und wiedergibt.]
 betrachten.
In der folgenden Grafik sind die Altersverteilungen aller Listen dargestellt, aufsteigend nach Median sortiert und im Verlgeich mit der Ulmer Bevölkerung (oben).

```{r fig.width=10, fig.asp=1.5, warning=FALSE, fig.align = 'center'}

# PLOT LISTEN EINZELN

plotAgeListen <- listen %>%
  ggplot(aes(x = Alter, y = Liste)) +
  geom_density_ridges_gradient(
    scale = 2.1, 
    rel_min_height = 0.01, 
    bandwidth = 1.5,
    quantile_lines = TRUE,
    vline_color = c("#56B4E9"),
    vline_width = 1.5,
    quantile_fun = median,
    jittered_points = TRUE, #https://cran.r-project.org/web/packages/ggridges/vignettes/introduction.html
    position = position_points_jitter(width = 0.7, height = 0),
    point_shape = 20, #https://ggplot2.tidyverse.org/reference/aes_linetype_size_shape.html
    point_size = 2, point_alpha = .5, alpha = 0.7#,
    ) +
  #scale_colour_manual(values = c("#999999", "#E69F00", "#56B4E9", "#E69F00", "#F0E442", "#0072B2", "#D55E00", "#CC79A7", "#999999", "#E69F00", "#56B4E9", "#E69F00", "#F0E442", "#0072B2", "#D55E00", "#CC79A7", "#999999")) +
  geom_vline(xintercept = 16, colour="#E69F00", linewidth = 1, show.legend = TRUE) +
  geom_vline(xintercept = demografieUlm2023Median, colour="#56B4E9", linetype = "longdash", linewidth = 1, show.legend = TRUE) +
  scale_fill_viridis() +
  scale_y_discrete(limits=rev, labels=rev(listenLabels$text)) +
  scale_x_continuous(limits=c(0, 100), breaks=seq(0, 90, by=5)) +
  #labs(title = 'Altersverteilungen') +
  theme_ipsum() +
  theme(
    legend.position="none",
    panel.spacing = unit(0.1, "lines"),
    strip.text.x = element_text(size = 8),
    axis.title.y=element_blank(),
    axis.title.x=element_blank()
  )
#plotAgeListen

```

```{r fig.width=10, fig.asp=1.6, message=FALSE, warning=FALSE, results='hide', fig.keep='all', fig.align = 'center'}

plotOben <- ggarrange(
  NA, plotDemografieUlmDistr,
  labels = c(NA, NA),
  widths = c(0.1, 1),
  nrow = 1, ncol = 2
  )

plotUnten <- ggarrange(
  NA, plotAgeListen,
  labels = c(NA, NA),
  widths = c(0, 1),
  nrow = 1, ncol = 2
  )

suppressWarnings( #TODO Wird das noch benötigt?
ggarrange(
  plotOben, plotUnten,
  vjust = 0,
  heights = c(2,12),
  nrow = 2, ncol = 1
  )
)

```


Beruflicher Hintergrund/Tätigkeit: TODO



# Etwas Hintergrund

Als Datengrundlage haben wir für diesen Bericht nur öffentlich zugängliche Quellen verwendet.
Insbesondere waren dies:

* die bekannt gemachten Wahlvorschläge [@ulm:wahlvorschlaege_grat_2024],
* die Zusammensetzung des aktuellen Gemeinderats [@ulm:aktrat; @ulm:aktrat_gebjahr] und 
* zum Vergleich die aktuelle Ulmer Statistik 2023 [@ulm:statistik2023], mit Daten zu den `r length(demografieUlm2023Distr$Alter)` Ulmer:innen.

Diese Daten haben wir soweit vor allem bzgl. der Altersstruktur ausgewertet.
Zeit ist immer knapp und deshalb haben wir auf die in den Wahlvorschlägen gemachten Berufsangaben bisher nur einen sehr kurzen Blick geworfen.
Eine tiefergehende Analyse der beruflichen Hintergründe und evtl. auch der aktuellen Tätigkeiten der Kandidat:innen könnte sich lohnen.
Ebenso haben wir noch keine Auswertung nach Stadtteilen versucht.

Dabei sind wir keine bezahlten Profis aus Journalismus, Verwaltung, Wissenschafft oder dergleichen, sondern im sogenannten [digitalen Ehrenamt](https://codefor.de/blog/fuenf-jahre-code-for-germany/) [engagierte](https://temporaerhaus.de/geschichte/) Bürger:innen.
Wir möchten mit diesem Bericht dazu einladen auch Darstellungen zu blättern und an den Stellen tiefer reinzuschauen, die Dich interessieren.
[Im Projekt auf GitHub](https://github.com/semaphor/politische-demografie-ulm) findest Du die aus den Quellen aufbereiteten Datensätze (Unterordner `/daten`) sowie den vollständigen Programmcode zur Auswertungen der Daten und Erstellung dieses Berichts (Startpunkt `overview.Rmd`).
<!-- Kenntnisse in R -->
Wir möchten also nicht nur zum reinschauen, sondern gerne auch zum [Mitmachen einladen](https://temporaerhaus.de/gruppen/ulmapi/)!
Ansatzpunkte, über die wir bisher nachgedacht haben und auch direkte Kontaktdaten findst Du ganz unten.


# Ausführlicher Bericht


## Altersstruktur

Da der Gemeinderat uns Ulmer:innen vertreten soll, ziehen wir die Bevölkerungsdaten aus der Ulmer Statistik 2023 [@ulm:statistik2023] zum Vergleich heran.
Diese enthält Daten mit dem Stichtag 31.12.2023 mit den folgenden Eckpunkten (weiter unten findest du noch etwas mehr Analyse).

* Personen insgesamt: `r length(demografieUlm2023Distr$Alter)`
* Median-Alter: `r demografieUlm2023Median`

Grafisch dargestellt ergibt sich folgendes Bild für die Altersverteilung:

```{r echo=FALSE}
#, message=FALSE, warning=FALSE, results='hide',fig.keep='all'} TODO Zeile könnte evtl. gelöscht werden?

# NOTIZEN ZUM CODE
# ================

# Knittr Options für Chunks:
# https://yihui.org/knitr/options/


# Fabenblindenfreundliche Farbpaletten:

#http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/#a-colorblind-friendly-palette
# The palette with grey:
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")

# The palette with black:
cbbPalette <- c("#000000", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")

#https://www.datanovia.com/en/blog/ggplot-colors-best-tricks-you-will-love/#set-custom-color-palettes
anotherPalette <- c("#FFDB6D", "#C4961A", "#F4EDCA", "#D16103", "#C3D7A4", "#52854C", "#4E84C4", "#293352")

```

```{r fig.width=10, fig.height=2.3, fig.align = 'center'}

plotDemografieUlmDistr

```

TODO Bildunterschrift: orange = Wahlalter 16; blau = Medianalter `r demografieUlm2023Median`


### Kandidat:innen zur Ulmer Gemeinderatswahl

Insgesamt kandidieren für die Wahl am 9. Juni `r nrow(listen)` Kandidat_innen auf `r length(levels(listen$Liste))` Listen für den nächsten Ulmer Gemeinderat (Wahlperiode 2024-2029) [@ulm:wahlvorschlaege_grat_2024].

<!-- TODO evtl. off by one, da keine Geburtstage, sondern nur -jahre vorliegen. -->

Tabelle mit statistischen Altersangaben **über alle Kandidat_innen**:

```{r}

# TABELLE ALTERSSTATISTIK ALLE KANDIDAT_INNEN
# ===========================================

listen %>%
 summarise(
    "Kandidat_innen" = n(),
    "min. Alter" = min(Alter),
    "max. Alter" = max(Alter),
    "Alter, Median" = median(Alter),
    "Alter, Durchschnitt" = round(mean(Alter),1),
    "Alter, Standardabw." = round(sd(Alter))
    ) %>%
  kable(style = 'bootstrap')

```


#### Vergleich Bevölkerung und alle Kanditat_innen

Grafische Darstellung der Alterstruktur aller Kandidat:innen zusammengefasst (unten) im Vergleich mit der Ulmer Bevölkerung (oben):

```{r fig.width=10, fig.asp=0.5, message=FALSE, warning=FALSE, results='hide', fig.keep='all', fig.align = 'center'}

# PLOT ULMER BEVÖLKERUNG versus ALLE KANDIDAT_INNEN (Variante: einzelne Diagramme)

plotOben <- ggarrange(
  NA, plotDemografieUlmDistr,
  labels = c(NA, NA),
  nrow = 1, ncol = 2,
  widths = c(0.062, 1) #TODO (nice to have) Verhältnis berechnen.
  )

plotUnten <- ggarrange(
  NA, plotAgeListenAlle,
  labels = c(NA, NA),
  nrow = 1, ncol = 2,
  widths = c(0, 1)
  )

suppressWarnings(
ggarrange(
  plotOben,
  plotUnten,
  nrow = 2, ncol = 1,
  heights = c(1,1),
  vjust = 0
  )
)

```


#### Vergleich der Listen


Tabelle mit Anzahl der Kandidatin_innen und statistischen Altersangaben **je Liste**:

```{r}

# TABELLE ALTERSSTATISTIK LISTEN
# ==============================

listen %>%
  group_by(Liste) %>%
  #TODO (nice to have) Nicht nach Median, z.B. alphabetisch sortieren? mutate(Liste = fct_reorder(Liste, Liste, .fun='sort(unique())')) %>%
  summarise(
    "Kandidat_innen" = n(),
    "min. Alter" = min(Alter),
    "max. Alter" = max(Alter),
    "Alter, Median" = median(Alter),
    "Alter, Durchschnitt" = round(mean(Alter),1),
    "Alter, Standardabw." = round(sd(Alter))
    ) %>%
  #TODO Statt hart gecodetem pageLength = 16 wäre eine Funktion schöner, https://stackoverflow.com/questions/64684661/can-you-change-the-r-default-table-length-when-outputting-with-the-dt-package
  datatable(style = 'bootstrap', options = list(pageLength = 16))


```

Grafische Darstellung je Liste (unten, `r length(levels(listen$Liste))` Kurven) im Vergleich mit der Ulmer Bevölkerung (oberes Diagramm). *TODO beschreiben, ausformulieren: Kurve -> Annährung zur bessere Darstellung. Normierung auf Fläche unter der Kurve. Da es sich um eine Annäherung und nicht um eine exakt Reprästentazion der Alterswerte handelt, verläuft die Kurz bspw. teilw. in Bereiche < 16 Jahre, also unter das Wahlalter.*

```{r fig.width=10, fig.asp=1.6, message=FALSE, warning=FALSE, results='hide', fig.keep='all', fig.align = 'center'}

plotOben <- ggarrange(
  NA, plotDemografieUlmDistr,
  labels = c(NA, NA),
  widths = c(0.1, 1),
  nrow = 1, ncol = 2
  )

plotUnten <- ggarrange(
  NA, plotAgeListen,
  labels = c(NA, NA),
  widths = c(0, 1),
  nrow = 1, ncol = 2
  )

suppressWarnings( #TODO Wird das noch benötigt?
ggarrange(
  plotOben, plotUnten,
  vjust = 0,
  heights = c(2,12),
  nrow = 2, ncol = 1
  )
)

```


### Aktueller Gemeinderat

Der aktuelle Gemeinderat (Wahlperiode 2019-2024) setzt sich aus `r length(aktRat$Alter)` Mitgliedern zusammen (40 + 1 Oberbürgermeister).

Tabelle mit statistischen Altersangaben **zum aktuellen Gemeinderat**:

```{r}

# TABELLE ALTERSSTATISTIK ALLE KANDIDAT_INNEN
# ===========================================

aktRat %>%
  summarise(
    "Mitglieder" = n(),
    "min. Alter" = min(Alter),
    "max. Alter" = max(Alter),
    "Alter, Median" = median(Alter),
    "Alter, Durchschnitt" = round(mean(Alter),1),
    "Alter, Standardabw." = round(sd(Alter))
    ) %>%
  kable(style = 'bootstrap')

```

Grafische Darstellung im Vergleich mit der Ulmer Bevölkerung (oben) der Altersstruktur des aktuellen Gemeinderats (mitte) und des aktuellen Gemeinderats, wenn er dieses Jahr gewählt werden würde ("-5 Jahre", unten):

```{r fig.width=10, fig.asp=1, fig.align = 'center'}

plotAktRatMinus5 <- aktRat %>%
  mutate(Alter = Alter - 5) %>%
  mutate(Fraktion = paste0('Gemeinderat\n2019-2024\n-5 Jahre\n(n = ', length(Alter), ',\nMedian = ', median(Alter), ')')) %>%
  ggplot(aes(x = Alter, y = Fraktion)) + #, fill = after_stat(x))) +
  geom_density_ridges_gradient(
    scale = 45,
    rel_min_height = 0.01,
    bandwidth = 1.5,
    quantile_lines = TRUE,
    vline_color = c("#56B4E9"),
    vline_width = 1.5,
    quantile_fun = median,
    jittered_points = TRUE, #https://cran.r-project.org/web/packages/ggridges/vignettes/introduction.html
    position = position_points_jitter(width = 0.7, height = 0),
    point_shape = 20, #https://ggplot2.tidyverse.org/reference/aes_linetype_size_shape.html
    point_size = 2, point_alpha = .5, alpha = 0.7
    ) +
  geom_vline(xintercept = 16, colour="#E69F00", linewidth = 0.8) +
  geom_vline(xintercept = demografieUlm2023Median, colour="#56B4E9", linetype = "longdash", linewidth = 0.8) +
  #scale_fill_viridis() +
  #scale_y_discrete(limits=rev, labels=rev(listenLabels$text)) +
  scale_x_continuous(limits=c(0,100), breaks=seq(0, 90, by=5)) +
  #labs(title = 'Altersverteilung Ulmer Bevölkerung') +
  theme_ipsum() +
  theme(
    legend.position="none",
    panel.spacing = unit(0.1, "lines"),
    strip.text.x = element_text(size = 8),
    axis.title.y=element_blank(),
    #axis.title.x=element_blank()
  )
#plotAktRatMinus5
```

```{r fig.width=10, fig.asp=0.6, message=FALSE, warning=FALSE, results='hide', fig.keep='all', fig.align = 'center'}

plotOben <- ggarrange(
  NA, plotDemografieUlmDistr,
  labels = c(NA, NA),
  nrow = 1, ncol = 2,
  widths = c(0, 1)
  )

plotUnten <- ggarrange(
  NA, plotAktRat,
  labels = c(NA, NA),
  widths = c(0, 1),
  nrow = 1, ncol = 2
  )

plotGanzUnten <- ggarrange(
  NA, plotAktRatMinus5,
  labels = c(NA, NA),
  widths = c(0, 1),
  nrow = 1, ncol = 2
  )

suppressWarnings(
ggarrange(
  plotOben,
  plotUnten,
  plotGanzUnten,
  nrow = 3, ncol = 1,
  vjust = 0,
  heights = c(1,1,1)
  )
)

```


### Ulmer Bevölkerung und Wahlberechtigte


<!--
#TODO Dezimalpunkte in der Zahlenausgabe
#TODO Altersgruppen/Quantile, evtl. als Tabelle.
-->


Wohnbevölkerung:

  * Gesamt: `r if (sum(demografieUlm2023$Wohnbevölkerung) == length(demografieUlm2023Distr$Alter)) {gesamt = sum(demografieUlm2023$Wohnbevölkerung); gesamt} else print("FEHLER: Ups, da ist was schief gegangen.")`
  * unter 16 Jahren (Wahlalter) : `r { unterWahlalter = sum(demografieUlm2023$Wohnbevölkerung[demografieUlm2023$Alter.von <= 15]); unterWahlalter }` (`r round(( unterWahlalter / gesamt )*100, 1)` %)
  * über 16 Jahre: `r { imWahlalter = gesamt - unterWahlalter; imWahlalter }` (`r round(( imWahlalter/gesamt )*100, 1)` %), von diesen:
    * Anteil bis unter Median-Alter der Gesamtbevölkerung (16 bis unter `r demografieUlm2023Median` Jahre): `r sum(demografieUlm2023$Wohnbevölkerung[demografieUlm2023$Alter.von >= 16 & demografieUlm2023$Alter.von < demografieUlm2023Median])` (`r round(( sum(demografieUlm2023$Wohnbevölkerung[demografieUlm2023$Alter.von >= 16 & demografieUlm2023$Alter.von < demografieUlm2023Median]) / gesamt )*100, 1)` % der Gesamtbevölkerung bzw.  `r round(( sum(demografieUlm2023$Wohnbevölkerung[demografieUlm2023$Alter.von >= 16 & demografieUlm2023$Alter.von < demografieUlm2023Median]) / imWahlalter )*100, 1)` % der ab 16-jährigen).
    * Anteil ab Median-Alter Gesamtbevölkerung (ab `r demografieUlm2023Median` Jahre): `r sum(demografieUlm2023$Wohnbevölkerung[demografieUlm2023$Alter.von >= demografieUlm2023Median])` (`r round(( sum(demografieUlm2023$Wohnbevölkerung[demografieUlm2023$Alter.von >= demografieUlm2023Median]) / gesamt )*100, 1)` % der Gesamtbevölkerung bzw. `r round(( sum(demografieUlm2023$Wohnbevölkerung[demografieUlm2023$Alter.von >= demografieUlm2023Median]) / imWahlalter )*100, 1)` % der ab 16-jährigen).
    * Von 16 bis unter 18 Jahren: `r sum(demografieUlm2023$Wohnbevölkerung[demografieUlm2023$Alter.von >= 16 & demografieUlm2023$Alter.von < 18])` (`r round(( sum(demografieUlm2023$Wohnbevölkerung[demografieUlm2023$Alter.von >= 16 & demografieUlm2023$Alter.von < 18]) / imWahlalter )*100, 1)` %).
* Zum Alter allgemein:
  * unter 20 Jahren: `r sum( demografieUlm2023$Wohnbevölkerung[demografieUlm2023$Alter.von < 20] )` (`r round(( sum(demografieUlm2023$Wohnbevölkerung[demografieUlm2023$Alter.von < 20] ) / gesamt )*100, 1)` %)
  * über 60 Jahren: `r sum( demografieUlm2023$Wohnbevölkerung[demografieUlm2023$Alter.von > 60] )` (`r round(( sum( demografieUlm2023$Wohnbevölkerung[demografieUlm2023$Alter.von > 60] ) / gesamt )*100, 1)` %)
  
Wahlberechtigte:

* Gesamt: `r wahlberechtigte`, wodurch sich folgende Anteile ergeben:
  * `r round(( wahlberechtigte/gesamt )*100, 1)` % der gesamten Wohnbevölkerung sind wahlberechtigt.
  * Von der Wohnbevölkerung ab 16 Jahren/im Wahlalter sind `r round(( wahlberechtigte / imWahlalter )*100, 1)` % wahlberechtigt.


Vergleich mit Baden-Württemberg, nach Schätzungen des Statistischen Landesamtes [@statlabw:kommwahlen2024] (Werte also ungefähr):

* Gesamtbevölkerung: 11,3 Millionen [@statlabw:bevoelkerung_viertelj]
* Wahlberechtigte: 8,6 Millionen (`r round(( 8.6 / 11.3 )*100, 1)` %; 7,8 Mio. Deutsche, 0,8 Mio. Unionsbürger_innen).
* Wahlberechtigte unter 18 Jahren: 190.000 (2,3 % der Wahlberechtigten).
* "Insgesamt sind ca. 10,9 % der wahlberechtigten Bevölkerung Baden-Württembergs zwischen 16 und 24 Jahren. In den Parlamenten ist diese Altersgruppe allerdings kaum vertreten, so sind derzeit im Landtag nur 0,6 % und im Bundestag nur 0,8 % der Abgeordneten unter 25 Jahren."
* Informationen zur Bevölkerungsentwicklung in Baden-Württemberg finden sich z.B. im Demografieportal des Bundes und der Länder [@demogrportal:bw_demogr].

Zum Datensatz:

* Quelle Wohnbevölkerung: Ulmer Statistik 2023 [@ulm:statistik2023], mit Stichtag 31.12.2023.
  * Auflösung der Daten: Altersgruppen von je 1 Jahr, ab 0 Jahren.
  * Letzter Datenpunkt enthält alle Personen 90 Jahre und älter, deshalb sieht man hier ein Ausreißer nach oben.
* Quelle Anzahl Wahlberechtigten: SWP [@swp:wahlunterlagen].


Grafische Darstellung der Altersstruktur der Ulmer Wohnbevölkerung:

```{r fig.width=7, fig.asp=0.33, fig.align = 'center'}

plotAgeUlm2023Distr <- ggplot(demografieUlm2023Distr, aes(Alter)) + 
  geom_histogram(binwidth = 1) +
  scale_x_continuous(breaks=seq(0, 90, by=10))

plotAgeUlm2023Distr

# Zum Vergleich hier optional eine Darstellung der ursprünglichen Daten aus [@ulm:statistik2023]:
#plotAgeUlm2023 <- ggplot(demografieUlm2023, aes(Alter.von, Wohnbevölkerung)) + 
#  geom_col(width = 0.5)
#
#plotAgeUlm2023


```

Alternativ stellt das Statstische Bundesamt (DESTATIS) in der GENESIS-Datenbank folgende Altersdaten mit akttuell letztem Stand vom 31.12.2022 [@destatis:12411-0018_ulm] zur Verfügung. Diese Daten sind also etwas älter und vor allem weniger fein aufgelöst. Alle Auswertungen in diesem Bericht basieren auf den Daten der Ulmer Statistik 2023, für Interessierte dennoch eine kurze Vorstellung:

Wohnbevölkerung DESTATIS:

* Gesamtzahl: `r sum(demografieUlmZehner$Personen)`

Grafische Darstellung der Altersstruktur der Ulmer Wohnbevölkerung nach DESTATIS-Datensatz:

```{r fig.width=7, fig.asp=0.4, fig.align = 'center'}
plotAgeUlm2022DES <- ggplot(demografieUlmZehner, aes(AltersgruppeZehner, Personen)) + 
  geom_col(width = 0.8)

plotAgeUlm2022DES


```


## Beruflicher Hintergrund

```{r}

# BERUFSANGABEN REDAKTIONELL BEREINIGEN:
#  * gegenderte Bezeichnungen
#  * rausschmeißen "i.R." "selbst." 

listen <- listen %>%
  mutate(Beruf = replace(Beruf, Beruf == "Student" | Beruf == 'Studentin', "Student_in")) %>%
  mutate(Beruf = replace(Beruf, Beruf == "Schüler" | Beruf == 'Schülerin', "Schüler_in")) %>%
  mutate(Beruf = replace(Beruf, Beruf == "Auszubildender" | Beruf == 'Auszubildende', "Auszubildende_r")) %>%
  mutate(Beruf = replace(Beruf, Beruf == "Arzt" | Beruf == 'Ärztin' | Beruf == 'Ärztin i.R.', "Ärzt_in")) %>%
  mutate(Beruf = replace(Beruf, Beruf == "Architekt" | Beruf == 'Architektin' | Beruf == "Freie Architektin", "Architekt_in")) %>%
  mutate(Beruf = replace(Beruf, Beruf == "Fraktionsgeschäftsführer" | Beruf == 'Fraktionsgeschäftsführerin', "Fraktionsgeschäftsführer_in")) %>%
  mutate(Beruf = replace(Beruf, Beruf == "Lehrer" | Beruf == 'Lehrerin' | Beruf == "Lehrer i.R." | Beruf == "Gymnasiallehrer" | Beruf == "Gymnasiallehrerin" | Beruf == "Kunstlehrerin", "Lehrer_in")) %>%
    mutate(Beruf = replace(Beruf,Beruf == "techn. Oberlehrer i.R." | Beruf == "techn. Oberlehrerin", "Berufsschullehrer_in")) %>%
  mutate(Beruf = replace(Beruf, Beruf == "Dipl. Betriebswirt (BA)" | Beruf == 'Dipl.- Betriebswirt (BA)' | Beruf == "	Dipl.-Betriebswirt (BA)", "Dipl. Betriebswirt_in (BA)")) %>%
  mutate(Beruf = replace(Beruf, Beruf == "selbst. Dipl.-Informatiker" | Beruf == 'Dipl.-Informatikerin', "Dipl.-Informatiker_in")) %>%
  mutate(Beruf = replace(Beruf, Beruf == "selbständig", "selbstständig")) %>%
  mutate(Beruf = replace(Beruf, Beruf == "Unternehmer" | Beruf == "Einzelunternehmer" | Beruf == "selbst. Unternehmer" | Beruf == "selbst. Unternehmerin" | Beruf == "Unternehmer IT-Services", "Unternehmer_in")) %>%
  mutate(Beruf = replace(Beruf, Beruf == "Geschäftsführer" | Beruf == "Geschäftsführerin", "Geschäftsführer_in")) %>%
  mutate(Beruf = replace(Beruf, Beruf == "Bankkaufmann" | Beruf == "Bankkauffrau", "Bankkaufleute")) %>%
  mutate(Beruf = replace(Beruf, Beruf == "Rechtsanwalt" | Beruf == "Rechtsanwältin" | Beruf == "Rechtsanwältin i.R.", "Rechtsanwält_in")) %>%
  mutate(Beruf = replace(Beruf, Beruf == "Rechtsanwaltsfach- angestellte", "Rechtsanwaltsfachangestellte")) %>%
  mutate(Beruf = replace(Beruf, Beruf == "kaufm. Angestellter", "kaufm. Angestellte_r")) %>%
  mutate(Beruf = replace(Beruf, Beruf == "Kaufmann" | Beruf == "IT-Systemkaufmann" | Beruf == "Speditionskaufmann" | Beruf == "selbst. Kaufmann", "Kaufleute")) %>%
  #mutate(Beruf = replace(Beruf, Beruf == "" | Beruf == "", "")) %>%
  #mutate(Beruf = replace(Beruf, Beruf == "" | Beruf == "", "")) %>%
  #mutate(Beruf = replace(Beruf, Beruf == "" | Beruf == "", "")) %>%
  mutate(Beruf = replace(Beruf, Beruf == "Psychologe" | Beruf == 'Psychologin' | Beruf == "Sportpsychologe" | Beruf == "Psychologin (B.sc.)", "Psycholog_in"))
#Psychologische Beraterin i.R.? Psychologische Psychotherapeutin?
```

In der Bekanntmachung der Wahlvorschläge ulm:wahlvorschlaege_grat_2024 wird "Beruf oder Stand" angegeben.
Wertet man dieses Datenfeld aus, ergeben sich für die `r nrow(listen)` Kandidat_innen erstmal `r length(unique(listen$BerufAngabe))` verschiedene Berufsangaben.
Nach unserer ersten redaktionellen Bereinigung (siehe Code) erhalten wir `r length(unique(listen$Beruf))` verschiedene Angaben zu Ausbildung, Beruf bzw. Tätigkeit, die in der folgenden Tabelle zusammengefasst werden.
Diese Bereinigung haben wir noch nicht vollständig abgeschlossen.
Die vollständige Liste, die alle angegebenen Berufe enthält, findet sich der [Datei kandidat_innen-2024-09-06.csv auf GitHub](https://github.com/semaphor/politische-demografie-ulm/blob/main/daten/kandidat_innen-2024-09-06.csv).


``` {r}
# Redaktionelle Zusammenfassung:
berufe <- listen %>%
            group_by(Beruf) %>%
            summarise(n = n()) %>%
            arrange(desc(n))

berufe %>%
  datatable(style = 'bootstrap', filter = 'top')

```


<!-- TODO Evtl. noch ein Abschnitt zu "Future Work" -->


# Vorgehensweise, Quellen und Autor_innen

Datenverarbeitung und Visualisierung mit der Statistiksoftware R.
Automatisierte Erstellung des reproduzier- und nachvollziehbaren Berichts (diese Website) mit R Markdown.
Veröffentlichung im Web mit GitHub (Actions).
Tausend Dank an alle Autor_innen der unzähligen genutzten freien Softwarepakte!

Daten und nachvollziehbare Datenverarbeitung auf GitHub: <https://github.com/semaphor/politische-demografie-ulm>

Unsere Ansatzpunkte für weitere Arbeit mit den Daten wären:

* Auswertung der Berufe nach Kategorien, wie bspw. nach den Lebensphasen Ausbildung/Erwerbstätigkeitsphase/Ruhstand und nach Sektoren Dienstleistung/Industrie/Gesundheit/Bildung und Erziehung/etc. Evtl. kann dieser Teil mit Hilfe der [O*Net-Datenbank](https://www.onetonline.org/) automatisiert werden, die auch eine API bietet, zu der es eine [entsprechende R-Bibliothek](https://github.com/eknud/ONETr) gibt. Hierfür müssten die Berufsangaben allerdings vorher ins Englische übersetzt werden, was ggf. über die [DeepL-API](https://cran.r-project.org/web/packages/deeplr/index.html) automatitisert werden könnte.
* Ausgangspunkte für eine Auswertung nach Stadtteilen:
  * [Altes ulmAPI-Projekt Clickthathood](http://www.ulmapi.de/project/2013/03/23/clickthathood.html), mit leider totem Link auf die Stadtviertel-Shapefiles im Datenportal der Stadt (auch wenn man den [Link repariert](https://datenportal.ulm.de/client/daten/single/stadtviertel-generalisiert)); die Shapefiles müssten aber sicher irgendwpo zu finden sein.
  * [Statistik-App "Statistik to go"](https://www.ulm.de/rathaus/stadtverwaltung/statistiken-und-offene-daten/statistik-app) bzw. <https://www.statistikapp-kosis.de/>
* Weitere Demografiedaten?
  * Gibt es da was bei [Wegweise Kommune](https://www.wegweiser-kommune.de/)? Dort bekommt man zumindest schonmal eine [PDF mit interessanten Daten](https://www.wegweiser-kommune.de/data-api/rest/export/demografische-entwicklung+ulm+2012-2021+tabelle.pdf) und das anscheinend aus einer REST API.
  * Evtl. direkt mit R vom Statistischen Bundesamt (DESTATIS) [abrufen](https://cran.r-project.org/web/packages/wiesbaden/vignettes/wiesbaden.html); diese Daten sind allerdings vermutlich schlechter aufgelöst, als die Daten aus der Ulmer Statistik.


Lizenz: [CC BY 4.0, Namensnennung und Verlinkung](https://creativecommons.org/licenses/by/4.0/)

Von: Jakob Pietron, Simon Lüke ([datalove/UlmAPI](http://www.ulmapi.de/) und sowieso [temporärhaus](https://temporaerhaus.de/), Augsburger Straße 25, 89231 Neu-Ulm)

Kontakt: datenanalyse-gemeinderat ÄTT resolution1.net


\
\
\
**Quellen und Fußnoten**

---
nocite: '@*'
---
